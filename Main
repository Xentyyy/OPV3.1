local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local tepekoyPlaceId = 16670640252 -- Tepeköy ID
local anaOyunPlaceId = 3231515867 -- Ana oyun ID (Gerçek ID'niz ile değiştirin)

local function deleteBots()
    local bots = workspace:FindFirstChild("Botlar")
    if bots then
        bots:Destroy()
        print("Botlar başarıyla silindi.")
    else
        print("Botlar bulunamadı.")
    end
end

local function getNil(name, class)
    for _, v in next, game:GetDescendants() do
        if v.ClassName == class and v.Name == name then
            return v
        end
    end
end

local function showNotification(message, duration)
    if game:GetService("UserInputService").TouchEnabled then return end

    local notificationGui = Instance.new("ScreenGui")
    notificationGui.Parent = player:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0.3, 0, 0.1, 0)
    frame.Position = UDim2.new(0.7, -10, 0.9, -10)
    frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    frame.BorderSizePixel = 2
    frame.BorderColor3 = Color3.fromRGB(255, 255, 255)
    frame.Parent = notificationGui

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.Text = message
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 24
    label.Parent = frame

    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://2865226178"
    sound.Parent = notificationGui
    sound:Play()

    task.wait(duration)
    notificationGui:Destroy()
end

local function isRegionCaptured(region)
    local flag = workspace:FindFirstChild(region.name .. "_Flag") -- Bölge bayrağı var mı?
    if flag and flag.BrickColor == BrickColor.new("Bright green") then
        return true -- Bölge ele geçirilmiş
    end
    return false
end

local function jumpAndStartFarm()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid", 10)

    if humanoid then
        humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
    else
        warn("Humanoid bulunamadı!")
        return
    end

    task.wait(1)

    local regions = {
        {name = "A"},
        {name = "B"},
        {name = "C"},
        {name = "D"},
        {name = "E"},
        {name = "F"},
        {name = "G"},
        {name = "H"}
    }

    local uncapturedRegions = #regions  -- Başlangıçta tüm bölgeler ele geçirilmemiştir.

    while uncapturedRegions > 0 do
        uncapturedRegions = 0  -- Her döngüde ele geçirilmemiş bölge sayısını sıfırla
        for _, region in ipairs(regions) do
            if not isRegionCaptured(region) then
                uncapturedRegions = uncapturedRegions + 1
                local point = getNil(region.name, "Part")
                if point and character:FindFirstChild("HumanoidRootPart") then
                    character.HumanoidRootPart.CFrame = point.CFrame * CFrame.new(0, 3, 0)
                    print(region.name .. " bölgesine gidildi, 5 saniye bekleniyor.")
                    task.wait(5)
                else
                    print(region.name .. " bölgesi bulunamadı veya HumanoidRootPart yok.")
                end
            end
        end

        task.wait(1)  -- Her döngüde 1 saniye bekle, bu sayede oyun donmaz
    end

    -- Farm tamamlandıktan sonra 6 saniye bekleniyor ve ardından ana oyuna geri dönülüyor
    showNotification("Farm tamamlandı, ana oyuna geri dönülüyor.", 3)
    task.wait(6)  -- Tüm bölgeler ele geçirildikten sonra 6 saniye bekleniyor
    TeleportService:Teleport(anaOyunPlaceId, player)
end

local function onTeleportCompleted()
    showNotification("Xenty iyi oyunlar diler...", 3)
    deleteBots()
    task.wait(1) -- Botların silinmesi için kısa bir süre bekleyin
    jumpAndStartFarm()
end

local function checkAndTeleport()
    local currentPlaceId = game.PlaceId
    if currentPlaceId ~= tepekoyPlaceId then
        showNotification("Tepeköye ışınlanıyorsunuz.", 3)
        TeleportService:Teleport(tepekoyPlaceId, player)
    else
        onTeleportCompleted()
    end
end 

checkAndTeleport()
